x2 = 0:20
z_1 <- c(1.52241035575357, 6.69405158107127, 11.36748041913, 16.5150704688625,
25.197684468949, 37.2729510427523, 49.7489827854298, 63.7812415138795,
81.4451517013702, 100.043167260407)
plot(x2, y)
test <- deriv(x = x2, y = y)
test
test
test[1]
test[2]
test[3]
deriv <- function(x, y, window = 1, blank = 0){
# first we need to log y
log_y <- log(y)
derivatives <- c()
#now you need to start window lm
for (i in 1:(length(log_y)-1)){
return((log_y[i+1] - log_y[i]) / (x[i+1]- y[i]))
}
}
x = -10:10
y = exp(x) / (1 + exp(x))
z = y + rnorm(length(y), 0,100)
x2 = 0:20
plot(x2, y)
test <- deriv(x = x2, y = y)
test
deriv <- function(times, meas, window = 1, blank = 0){
# first we need to log y
log_y <- log(meas)
#now you need to start window lm
for (i in 1:(length(log_y)-1)){
slope <- (log_y[i+1] - log_y[i]) / (times[i+1]- times[i])
return(slope)
}
}
test <- deriv(time = x2, meas = y)
test
?sum
sum
deriv <- function(times, meas, window = 1, blank = 0){
# first we need to log y
log_y <- log(meas)
ans <- rep(NA, length(meas))
for (i in 1:(length(log_y)-1)){
slope <- (log_y[i+1] - log_y[i]) / (times[i+1]- times[i])
ans[i] <- slope
}
}
x = -10:10
y = exp(x) / (1 + exp(x))
z = y + rnorm(length(y), 0,100)
x2 = 0:20
plot(x2, y)
test <- deriv(time = x2, meas = y)
test
rep(NA, 3)
test <- rep(NA, 5)
test[3]
test[3] <- 2
test[3]
deriv <- function(times, meas, window = 1, blank = 0){
# first we need to log y
log_y <- log(meas)
ans <- rep(NA, length(meas))
for (i in 1:(length(log_y)-1)){
slope <- (log_y[i+1] - log_y[i]) / (times[i+1]- times[i])
ans[i] <- slope
}
return(ans)
}
x = -10:10
y = exp(x) / (1 + exp(x))
z = y + rnorm(length(y), 0,100)
x2 = 0:20
plot(x2, y)
test <- deriv(time = x2, meas = y)
test
length(y)
length(test)
plot(x2, test)
deriv <- function(times, meas, window = 1, blank = 0){
# first we need to log y
log_y <- log(meas)
ans <- rep(NA, length(meas))
for (i in 1:(length(log_y)-1)){
slope <- (log_y[i+1] - log_y[i]) / (times[i+1]- meas[i])
ans[i] <- slope
}
return(ans)
}
test <- deriv(time = x2, meas = y)
test
plot(x2, test)
# first we need to log y
log_y <- log(y)
derivatives <- c()
#now you need to start window lm
for (i in 1:(length(log_y)-1)){
slope <- (log_y[i+1] - log_y[i]) / (x[i+1]- y[i])
return(slope)
}
print(slope)
#now you need to start window lm
for (i in 1:(length(log_y)-1)){
slope <- (log_y[i+1] - log_y[i]) / (x[i+1]- y[i])
print(slope)
}
deriv <- function(times, meas, window = 1, blank = 0){
# first we need to log y
log_y <- log(meas)
ans <- rep(NA, length(meas))
for (i in 1:(length(log_y)-1)){
slope <- ((log_y[i+1] - log_y[i]) / (times[i+1]- times[i]))
ans[i] <- slope
}
return(ans)
}
plot(x2, y)
test <- deriv(time = x2, meas = y)
test
plot(x2, test)
# first we need to log y
log_y <- log(y)
derivatives <- c()
#now you need to start window lm
for (i in 1:(length(log_y)-1)){
slope <- (log_y[i+1] - log_y[i]) / (x[i+1]- x[i])
print(slope)
}
slope <- (log_y[i+1] - log_y[i]) / (x2[i+1]- x2[i])
# first we need to log y
log_y <- log(y)
derivatives <- c()
#now you need to start window lm
for (i in 1:(length(log_y)-1)){
slope <- (log_y[i+1] - log_y[i]) / (x2[i+1]- x2[i])
print(slope)
}
slope <- (log_y[i+1] - log_y[i]) / (x2[i+1]- x[i])
print(slope)
# first we need to log y
log_y <- log(y)
derivatives <- c()
#now you need to start window lm
for (i in 1:(length(log_y)-1)){
slope <- (log_y[i+1] - log_y[i]) / (x2[i+1]- x[i])
print(slope)
}
derivatives <- c()
#now you need to start window lm
for (i in 1:(length(log_y)-1)){
slope <- (log_y[i+1] - log_y[i]) / (x[i+1]- x[i])
print(slope)
}
x = -10:10
y = exp(x) / (1 + exp(x))
z = y + rnorm(length(y), 0,100)
x2 = 0:20
plot(x2, y)
test <- deriv(time = x2, meas = y)
test
plot(x2, test)
# first we need to log y
log_y <- log(y)
derivatives <- c()
#now you need to start window lm
for (i in 1:(length(log_y)-1)){
slope <- (log_y[i+1] - log_y[i]) / (x[i+1]- x[i])
print(slope)
}
slope <- (log_y[i+1] - log_y[i]) / (x[i+1]- y[i])
print(slope)
#now you need to start window lm
for (i in 1:(length(log_y)-1)){
slope <- (log_y[i+1] - log_y[i]) / (x[i+1]- y[i])
print(slope)
}
deriv <- function(times, meas, window = 1, blank = 0){
# first we need to log y
log_y <- log(meas)
ans <- rep(NA, length(meas))
for (i in 1:(length(log_y)-1)){
slope <- ((log_y[i+1] - log_y[i]) / (times[i+1]- meas[i]))
ans[i] <- slope
}
return(ans)
}
x = -10:10
y = exp(x) / (1 + exp(x))
z = y + rnorm(length(y), 0,100)
x2 = 0:20
plot(x2, y)
test <- deriv(time = x2, meas = y)
test
plot(x2, test)
# first we need to log y
log_y <- log(y)
test
slope <- ((log_y[i+1] - log_y[i]) / ((times[i+1] - length(times)/2) - meas[i]))
deriv <- function(times, meas, window = 1, blank = 0){
# first we need to log y
log_y <- log(meas)
ans <- rep(NA, length(meas))
for (i in 1:(length(log_y)-1)){
slope <- ((log_y[i+1] - log_y[i]) / ((times[i+1] - length(times)/2) - meas[i]))
ans[i] <- slope
}
return(ans)
}
test <- deriv(time = x2, meas = y)
test
plot(x2, test)
deriv <- function(times, meas, window = 1, blank = 0){
# first we need to log y
log_y <- log(meas)
ans <- rep(NA, length(meas))
for (i in 1:(length(log_y)-1)){
slope <- ((log_y[i+1] - log_y[i]) / ((times[i+1] - length(times)/2) - meas[i]))
ans[i] <- slope
}
return(ans)
}
test <- deriv(time = x2, meas = y)
test
plot(x2, test)
x = -10:10
y = exp(x) / (1 + exp(x))
z = y + rnorm(length(y), 0,100)
x2 = 0:20
plot(x2, y)
test <- deriv(time = x2, meas = y)
test
plot(x2, test)
# first we need to log y
log_y <- log(y)
derivatives <- c()
#now you need to start window lm
for (i in 1:(length(log_y)-1)){
slope <- (log_y[i+1] - log_y[i]) / (x[i+1]- y[i])
print(slope)
}
x = -10:10
y = exp(x) / (1 + exp(x))
z = y + rnorm(length(y), 0,1)
x2 = 0:20
plot(x2, y)
test <- deriv(time = x2, meas = y)
test
plot(x2, test)
deriv <- function(times, meas, window = 1, blank = 0){
# first we need to log y
log_y <- log(meas)
ans <- rep(NA, length(meas))
for (i in 1:(length(log_y)-1)){
slope <- abs(((log_y[i+1] - log_y[i]) / ((times[i+1] - length(times)/2) - meas[i])))
ans[i] <- slope
}
return(ans)
}
x = -10:10
y = exp(x) / (1 + exp(x))
z = y + rnorm(length(y), 0,1)
x2 = 0:20
plot(x2, y)
test <- deriv(time = x2, meas = y)
test
plot(x2, test)
# first we need to log y
log_y <- log(y)
1/0
# First Idea:
# Some weird slope function
deriv <- function(times, meas){
# first we need to log y
log_y <- log(meas)
ans <- rep(NA, length(meas))
ans[1] <- 0
for (i in 1:(length(log_y)-1)){
slope <- abs(((log_y[i+1] - log_y[i]) / ((times[i+1] - length(times)/2) - meas[i])))
ans[i+1] <- slope
}
return(ans)
}
x = -10:10
y = exp(x) / (1 + exp(x))
z = y + rnorm(length(y), 0,1)
x2 = 0:20
plot(x2, y)
test <- deriv(time = x2, meas = y)
test
plot(x2, test)
test
# Create function to find lag time
lagtime <- function(time, meas, differences){
# first find max point in differences
maxgrowth <- which.max(differences)
# need slope
slope1 <- ((meas[maxgrowth + 1] - meas[maxgrowth]) / (time[maxgrowth + 1] - time[maxgrowth]))
slope2 <- ((meas[maxgrowth] - meas[maxgrowth - 1]) / (time[maxgrowth] - time[maxgrowth - 1]))
slope <- (slope1 + slope2) / 2
#fit tangent line to the point
y <- slope * (x - time[maxgrowth]) - meas[maxgrowth]
# y−y1=m(x−x1)
#find where it intersects with min meas value
min_meas <- min(meas)
lag <- ((min_meas - meas[maxgrowth]) / slope) + time[maxgrowth]
#return lagtime
return(lag)
}
x = -10:10
y = exp(x) / (1 + exp(x))
z = y + rnorm(length(y), 0,.02)
x2 = 0:20
plot(x2, z)
plot(x2, z)
plot(x2, z)
test <- deriv(time = x2, meas = z)
test
plot(x2, test)
test <- differences(time = x2, meas = z, showplot = TRUE)
# Second Idea:
# Some differences function
differences <- function(times, meas, showplot = FALSE){
ans <- rep(NA, length(meas))
ans[1] <- 0
for (i in 1:(length(meas)-1)){
slope <- meas[i+1] - meas[i]
ans[i+1] <- slope
}
if(showplot == TRUE){
plot(times, ans, type = "l")
}
return(ans)
}
test <- differences(time = x2, meas = z, showplot = TRUE)
test
lag <- lagtime(time = x2, meas = z, differences = test)
lag
plot(x2, z)
plot(x2, z)
abline(v = 7.966322)
plot(x2, log(z))
abline(v = 7.966322)
plot(x2, z)
abline(v = 7.966322)
# Create function to find lag time
lagtime <- function(time, meas, differences){
# first find max point in differences
maxgrowth <- which.max(differences)
# need slope
slope1 <- ((meas[maxgrowth + 1] - meas[maxgrowth]) / (time[maxgrowth + 1] - time[maxgrowth]))
slope2 <- ((meas[maxgrowth] - meas[maxgrowth - 1]) / (time[maxgrowth] - time[maxgrowth - 1]))
slope <- (slope1 + slope2) / 2
#fit tangent line to the point
y <- slope * (x - time[maxgrowth]) - meas[maxgrowth]
# y−y1=m(x−x1)
#find where it intersects with min meas value
min_meas <- min(meas)
lag <- ((min_meas - meas[maxgrowth]) / slope) + time[maxgrowth]
if(showplot == TRUE){
plot(times, meas)
abline(v = lag)
}
#return lagtime
return(lag)
}
# Create function to find lag time
lagtime <- function(time, meas, differences, showplot = FALSE){
# first find max point in differences
maxgrowth <- which.max(differences)
# need slope
slope1 <- ((meas[maxgrowth + 1] - meas[maxgrowth]) / (time[maxgrowth + 1] - time[maxgrowth]))
slope2 <- ((meas[maxgrowth] - meas[maxgrowth - 1]) / (time[maxgrowth] - time[maxgrowth - 1]))
slope <- (slope1 + slope2) / 2
#fit tangent line to the point
y <- slope * (x - time[maxgrowth]) - meas[maxgrowth]
# y−y1=m(x−x1)
#find where it intersects with min meas value
min_meas <- min(meas)
lag <- ((min_meas - meas[maxgrowth]) / slope) + time[maxgrowth]
if(showplot == TRUE){
plot(times, meas)
abline(v = lag)
}
#return lagtime
return(lag)
}
lag <- lagtime(time = x2, meas = z, differences = test, showplot = TRUE)
# Create function to find lag time
lagtime <- function(time, meas, differences, showplot = FALSE){
# first find max point in differences
maxgrowth <- which.max(differences)
# need slope
slope1 <- ((meas[maxgrowth + 1] - meas[maxgrowth]) / (time[maxgrowth + 1] - time[maxgrowth]))
slope2 <- ((meas[maxgrowth] - meas[maxgrowth - 1]) / (time[maxgrowth] - time[maxgrowth - 1]))
slope <- (slope1 + slope2) / 2
#fit tangent line to the point
y <- slope * (x - time[maxgrowth]) - meas[maxgrowth]
# y−y1=m(x−x1)
#find where it intersects with min meas value
min_meas <- min(meas)
lag <- ((min_meas - meas[maxgrowth]) / slope) + time[maxgrowth]
if(showplot == TRUE){
plot(time, meas)
abline(v = lag)
}
#return lagtime
return(lag)
}
lag <- lagtime(time = x2, meas = z, differences = test, showplot = TRUE)
lag
lag <- lagtime(time = x2, meas = z, differences = test, showplot = TRUE)
?abline
# Create function to find lag time
lagtime <- function(time, meas, differences, showplot = FALSE){
# first find max point in differences
maxgrowth <- which.max(differences)
# need slope
slope1 <- ((meas[maxgrowth + 1] - meas[maxgrowth]) / (time[maxgrowth + 1] - time[maxgrowth]))
slope2 <- ((meas[maxgrowth] - meas[maxgrowth - 1]) / (time[maxgrowth] - time[maxgrowth - 1]))
slope <- (slope1 + slope2) / 2
#fit tangent line to the point
y <- slope * (x - time[maxgrowth]) - meas[maxgrowth]
# y−y1=m(x−x1)
#find where it intersects with min meas value
min_meas <- min(meas)
lag <- ((min_meas - meas[maxgrowth]) / slope) + time[maxgrowth]
if(showplot == TRUE){
plot(time, meas)
lines(time, y)
abline(h = min_meas)
abline(v = lag)
}
#return lagtime
return(lag)
}
lag <- lagtime(time = x2, meas = z, differences = test, showplot = TRUE)
?lines
# Create function to find lag time
lagtime <- function(time, meas, differences, showplot = FALSE){
# first find max point in differences
maxgrowth <- which.max(differences)
# need slope
slope1 <- ((meas[maxgrowth + 1] - meas[maxgrowth]) / (time[maxgrowth + 1] - time[maxgrowth]))
slope2 <- ((meas[maxgrowth] - meas[maxgrowth - 1]) / (time[maxgrowth] - time[maxgrowth - 1]))
slope <- (slope1 + slope2) / 2
#fit tangent line to the point
y <- slope * (x - time[maxgrowth]) - meas[maxgrowth]
# y−y1=m(x−x1)
#find where it intersects with min meas value
min_meas <- min(meas)
lag <- ((min_meas - meas[maxgrowth]) / slope) + time[maxgrowth]
if(showplot == TRUE){
plot(time, meas)
lines(time, y, type = "l")
abline(h = min_meas)
abline(v = lag)
}
#return lagtime
return(lag)
}
lag <- lagtime(time = x2, meas = z, differences = test, showplot = TRUE)
# Create function to find lag time
lagtime <- function(time, meas, differences, showplot = FALSE){
# first find max point in differences
maxgrowth <- which.max(differences)
# need slope
slope1 <- ((meas[maxgrowth + 1] - meas[maxgrowth]) / (time[maxgrowth + 1] - time[maxgrowth]))
slope2 <- ((meas[maxgrowth] - meas[maxgrowth - 1]) / (time[maxgrowth] - time[maxgrowth - 1]))
slope <- (slope1 + slope2) / 2
#fit tangent line to the point
y <- slope * (time - time[maxgrowth]) - meas[maxgrowth]
# y−y1=m(x−x1)
#find where it intersects with min meas value
min_meas <- min(meas)
lag <- ((min_meas - meas[maxgrowth]) / slope) + time[maxgrowth]
if(showplot == TRUE){
plot(time, meas)
lines(time, y, type = "l")
abline(h = min_meas)
abline(v = lag)
}
#return lagtime
return(lag)
}
lag <- lagtime(time = x2, meas = z, differences = test, showplot = TRUE)
lag
# Create function to find lag time
lagtime <- function(time, meas, differences, showplot = FALSE){
# first find max point in differences
maxgrowth <- which.max(differences)
# need slope
slope1 <- ((meas[maxgrowth + 1] - meas[maxgrowth]) / (time[maxgrowth + 1] - time[maxgrowth]))
slope2 <- ((meas[maxgrowth] - meas[maxgrowth - 1]) / (time[maxgrowth] - time[maxgrowth - 1]))
slope <- (slope1 + slope2) / 2
#fit tangent line to the point
y <- slope * (time - time[maxgrowth]) - meas[maxgrowth]
# y−y1=m(x−x1)
#find where it intersects with min meas value
min_meas <- min(meas)
lag <- ((min_meas - meas[maxgrowth]) / slope) + time[maxgrowth]
if(showplot == TRUE){
plot(time, meas)
lines(time, y)
abline(h = min_meas)
abline(v = lag)
}
#return lagtime
return(lag)
}
lag <- lagtime(time = x2, meas = z, differences = test, showplot = TRUE)
