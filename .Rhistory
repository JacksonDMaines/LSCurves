test <- deriv(time = x2, meas = y)
test
plot(x2, test)
# first we need to log y
log_y <- log(y)
derivatives <- c()
#now you need to start window lm
for (i in 1:(length(log_y)-1)){
slope <- (log_y[i+1] - log_y[i]) / (x[i+1]- x[i])
print(slope)
}
slope <- (log_y[i+1] - log_y[i]) / (x[i+1]- y[i])
print(slope)
#now you need to start window lm
for (i in 1:(length(log_y)-1)){
slope <- (log_y[i+1] - log_y[i]) / (x[i+1]- y[i])
print(slope)
}
deriv <- function(times, meas, window = 1, blank = 0){
# first we need to log y
log_y <- log(meas)
ans <- rep(NA, length(meas))
for (i in 1:(length(log_y)-1)){
slope <- ((log_y[i+1] - log_y[i]) / (times[i+1]- meas[i]))
ans[i] <- slope
}
return(ans)
}
x = -10:10
y = exp(x) / (1 + exp(x))
z = y + rnorm(length(y), 0,100)
x2 = 0:20
plot(x2, y)
test <- deriv(time = x2, meas = y)
test
plot(x2, test)
# first we need to log y
log_y <- log(y)
test
slope <- ((log_y[i+1] - log_y[i]) / ((times[i+1] - length(times)/2) - meas[i]))
deriv <- function(times, meas, window = 1, blank = 0){
# first we need to log y
log_y <- log(meas)
ans <- rep(NA, length(meas))
for (i in 1:(length(log_y)-1)){
slope <- ((log_y[i+1] - log_y[i]) / ((times[i+1] - length(times)/2) - meas[i]))
ans[i] <- slope
}
return(ans)
}
test <- deriv(time = x2, meas = y)
test
plot(x2, test)
deriv <- function(times, meas, window = 1, blank = 0){
# first we need to log y
log_y <- log(meas)
ans <- rep(NA, length(meas))
for (i in 1:(length(log_y)-1)){
slope <- ((log_y[i+1] - log_y[i]) / ((times[i+1] - length(times)/2) - meas[i]))
ans[i] <- slope
}
return(ans)
}
test <- deriv(time = x2, meas = y)
test
plot(x2, test)
x = -10:10
y = exp(x) / (1 + exp(x))
z = y + rnorm(length(y), 0,100)
x2 = 0:20
plot(x2, y)
test <- deriv(time = x2, meas = y)
test
plot(x2, test)
# first we need to log y
log_y <- log(y)
derivatives <- c()
#now you need to start window lm
for (i in 1:(length(log_y)-1)){
slope <- (log_y[i+1] - log_y[i]) / (x[i+1]- y[i])
print(slope)
}
x = -10:10
y = exp(x) / (1 + exp(x))
z = y + rnorm(length(y), 0,1)
x2 = 0:20
plot(x2, y)
test <- deriv(time = x2, meas = y)
test
plot(x2, test)
deriv <- function(times, meas, window = 1, blank = 0){
# first we need to log y
log_y <- log(meas)
ans <- rep(NA, length(meas))
for (i in 1:(length(log_y)-1)){
slope <- abs(((log_y[i+1] - log_y[i]) / ((times[i+1] - length(times)/2) - meas[i])))
ans[i] <- slope
}
return(ans)
}
x = -10:10
y = exp(x) / (1 + exp(x))
z = y + rnorm(length(y), 0,1)
x2 = 0:20
plot(x2, y)
test <- deriv(time = x2, meas = y)
test
plot(x2, test)
# first we need to log y
log_y <- log(y)
1/0
# First Idea:
# Some weird slope function
deriv <- function(times, meas){
# first we need to log y
log_y <- log(meas)
ans <- rep(NA, length(meas))
ans[1] <- 0
for (i in 1:(length(log_y)-1)){
slope <- abs(((log_y[i+1] - log_y[i]) / ((times[i+1] - length(times)/2) - meas[i])))
ans[i+1] <- slope
}
return(ans)
}
x = -10:10
y = exp(x) / (1 + exp(x))
z = y + rnorm(length(y), 0,1)
x2 = 0:20
plot(x2, y)
test <- deriv(time = x2, meas = y)
test
plot(x2, test)
test
# Create function to find lag time
lagtime <- function(time, meas, differences){
# first find max point in differences
maxgrowth <- which.max(differences)
# need slope
slope1 <- ((meas[maxgrowth + 1] - meas[maxgrowth]) / (time[maxgrowth + 1] - time[maxgrowth]))
slope2 <- ((meas[maxgrowth] - meas[maxgrowth - 1]) / (time[maxgrowth] - time[maxgrowth - 1]))
slope <- (slope1 + slope2) / 2
#fit tangent line to the point
y <- slope * (x - time[maxgrowth]) - meas[maxgrowth]
# y−y1=m(x−x1)
#find where it intersects with min meas value
min_meas <- min(meas)
lag <- ((min_meas - meas[maxgrowth]) / slope) + time[maxgrowth]
#return lagtime
return(lag)
}
x = -10:10
y = exp(x) / (1 + exp(x))
z = y + rnorm(length(y), 0,.02)
x2 = 0:20
plot(x2, z)
plot(x2, z)
plot(x2, z)
test <- deriv(time = x2, meas = z)
test
plot(x2, test)
test <- differences(time = x2, meas = z, showplot = TRUE)
# Second Idea:
# Some differences function
differences <- function(times, meas, showplot = FALSE){
ans <- rep(NA, length(meas))
ans[1] <- 0
for (i in 1:(length(meas)-1)){
slope <- meas[i+1] - meas[i]
ans[i+1] <- slope
}
if(showplot == TRUE){
plot(times, ans, type = "l")
}
return(ans)
}
test <- differences(time = x2, meas = z, showplot = TRUE)
test
lag <- lagtime(time = x2, meas = z, differences = test)
lag
plot(x2, z)
plot(x2, z)
abline(v = 7.966322)
plot(x2, log(z))
abline(v = 7.966322)
plot(x2, z)
abline(v = 7.966322)
# Create function to find lag time
lagtime <- function(time, meas, differences){
# first find max point in differences
maxgrowth <- which.max(differences)
# need slope
slope1 <- ((meas[maxgrowth + 1] - meas[maxgrowth]) / (time[maxgrowth + 1] - time[maxgrowth]))
slope2 <- ((meas[maxgrowth] - meas[maxgrowth - 1]) / (time[maxgrowth] - time[maxgrowth - 1]))
slope <- (slope1 + slope2) / 2
#fit tangent line to the point
y <- slope * (x - time[maxgrowth]) - meas[maxgrowth]
# y−y1=m(x−x1)
#find where it intersects with min meas value
min_meas <- min(meas)
lag <- ((min_meas - meas[maxgrowth]) / slope) + time[maxgrowth]
if(showplot == TRUE){
plot(times, meas)
abline(v = lag)
}
#return lagtime
return(lag)
}
# Create function to find lag time
lagtime <- function(time, meas, differences, showplot = FALSE){
# first find max point in differences
maxgrowth <- which.max(differences)
# need slope
slope1 <- ((meas[maxgrowth + 1] - meas[maxgrowth]) / (time[maxgrowth + 1] - time[maxgrowth]))
slope2 <- ((meas[maxgrowth] - meas[maxgrowth - 1]) / (time[maxgrowth] - time[maxgrowth - 1]))
slope <- (slope1 + slope2) / 2
#fit tangent line to the point
y <- slope * (x - time[maxgrowth]) - meas[maxgrowth]
# y−y1=m(x−x1)
#find where it intersects with min meas value
min_meas <- min(meas)
lag <- ((min_meas - meas[maxgrowth]) / slope) + time[maxgrowth]
if(showplot == TRUE){
plot(times, meas)
abline(v = lag)
}
#return lagtime
return(lag)
}
lag <- lagtime(time = x2, meas = z, differences = test, showplot = TRUE)
# Create function to find lag time
lagtime <- function(time, meas, differences, showplot = FALSE){
# first find max point in differences
maxgrowth <- which.max(differences)
# need slope
slope1 <- ((meas[maxgrowth + 1] - meas[maxgrowth]) / (time[maxgrowth + 1] - time[maxgrowth]))
slope2 <- ((meas[maxgrowth] - meas[maxgrowth - 1]) / (time[maxgrowth] - time[maxgrowth - 1]))
slope <- (slope1 + slope2) / 2
#fit tangent line to the point
y <- slope * (x - time[maxgrowth]) - meas[maxgrowth]
# y−y1=m(x−x1)
#find where it intersects with min meas value
min_meas <- min(meas)
lag <- ((min_meas - meas[maxgrowth]) / slope) + time[maxgrowth]
if(showplot == TRUE){
plot(time, meas)
abline(v = lag)
}
#return lagtime
return(lag)
}
lag <- lagtime(time = x2, meas = z, differences = test, showplot = TRUE)
lag
lag <- lagtime(time = x2, meas = z, differences = test, showplot = TRUE)
?abline
# Create function to find lag time
lagtime <- function(time, meas, differences, showplot = FALSE){
# first find max point in differences
maxgrowth <- which.max(differences)
# need slope
slope1 <- ((meas[maxgrowth + 1] - meas[maxgrowth]) / (time[maxgrowth + 1] - time[maxgrowth]))
slope2 <- ((meas[maxgrowth] - meas[maxgrowth - 1]) / (time[maxgrowth] - time[maxgrowth - 1]))
slope <- (slope1 + slope2) / 2
#fit tangent line to the point
y <- slope * (x - time[maxgrowth]) - meas[maxgrowth]
# y−y1=m(x−x1)
#find where it intersects with min meas value
min_meas <- min(meas)
lag <- ((min_meas - meas[maxgrowth]) / slope) + time[maxgrowth]
if(showplot == TRUE){
plot(time, meas)
lines(time, y)
abline(h = min_meas)
abline(v = lag)
}
#return lagtime
return(lag)
}
lag <- lagtime(time = x2, meas = z, differences = test, showplot = TRUE)
?lines
# Create function to find lag time
lagtime <- function(time, meas, differences, showplot = FALSE){
# first find max point in differences
maxgrowth <- which.max(differences)
# need slope
slope1 <- ((meas[maxgrowth + 1] - meas[maxgrowth]) / (time[maxgrowth + 1] - time[maxgrowth]))
slope2 <- ((meas[maxgrowth] - meas[maxgrowth - 1]) / (time[maxgrowth] - time[maxgrowth - 1]))
slope <- (slope1 + slope2) / 2
#fit tangent line to the point
y <- slope * (x - time[maxgrowth]) - meas[maxgrowth]
# y−y1=m(x−x1)
#find where it intersects with min meas value
min_meas <- min(meas)
lag <- ((min_meas - meas[maxgrowth]) / slope) + time[maxgrowth]
if(showplot == TRUE){
plot(time, meas)
lines(time, y, type = "l")
abline(h = min_meas)
abline(v = lag)
}
#return lagtime
return(lag)
}
lag <- lagtime(time = x2, meas = z, differences = test, showplot = TRUE)
# Create function to find lag time
lagtime <- function(time, meas, differences, showplot = FALSE){
# first find max point in differences
maxgrowth <- which.max(differences)
# need slope
slope1 <- ((meas[maxgrowth + 1] - meas[maxgrowth]) / (time[maxgrowth + 1] - time[maxgrowth]))
slope2 <- ((meas[maxgrowth] - meas[maxgrowth - 1]) / (time[maxgrowth] - time[maxgrowth - 1]))
slope <- (slope1 + slope2) / 2
#fit tangent line to the point
y <- slope * (time - time[maxgrowth]) - meas[maxgrowth]
# y−y1=m(x−x1)
#find where it intersects with min meas value
min_meas <- min(meas)
lag <- ((min_meas - meas[maxgrowth]) / slope) + time[maxgrowth]
if(showplot == TRUE){
plot(time, meas)
lines(time, y, type = "l")
abline(h = min_meas)
abline(v = lag)
}
#return lagtime
return(lag)
}
lag <- lagtime(time = x2, meas = z, differences = test, showplot = TRUE)
lag
# Create function to find lag time
lagtime <- function(time, meas, differences, showplot = FALSE){
# first find max point in differences
maxgrowth <- which.max(differences)
# need slope
slope1 <- ((meas[maxgrowth + 1] - meas[maxgrowth]) / (time[maxgrowth + 1] - time[maxgrowth]))
slope2 <- ((meas[maxgrowth] - meas[maxgrowth - 1]) / (time[maxgrowth] - time[maxgrowth - 1]))
slope <- (slope1 + slope2) / 2
#fit tangent line to the point
y <- slope * (time - time[maxgrowth]) - meas[maxgrowth]
# y−y1=m(x−x1)
#find where it intersects with min meas value
min_meas <- min(meas)
lag <- ((min_meas - meas[maxgrowth]) / slope) + time[maxgrowth]
if(showplot == TRUE){
plot(time, meas)
lines(time, y)
abline(h = min_meas)
abline(v = lag)
}
#return lagtime
return(lag)
}
lag <- lagtime(time = x2, meas = z, differences = test, showplot = TRUE)
# Create function to find lag time
lagtime <- function(time, meas, differences, showplot = FALSE){
# first find max point in differences
maxgrowth <- which.max(differences)
# need slope
slope1 <- ((meas[maxgrowth + 1] - meas[maxgrowth]) / (time[maxgrowth + 1] - time[maxgrowth]))
slope2 <- ((meas[maxgrowth] - meas[maxgrowth - 1]) / (time[maxgrowth] - time[maxgrowth - 1]))
slope <- (slope1 + slope2) / 2
#fit tangent line to the point
y <- slope * (time - time[maxgrowth]) - meas[maxgrowth]
# y−y1=m(x−x1)
#find where it intersects with min meas value
min_meas <- min(meas)
lag <- ((min_meas - meas[maxgrowth]) / slope) + time[maxgrowth]
if(showplot == TRUE){
plot(time, meas)
lines(time, y)
abline(h = min_meas)
abline(v = lag)
}
#return lagtime
return(lag)
}
# Third Idea:
# Fit lm between points and find rate of change by subtracting last slope
# by new slope?
deriv2 <- function(time, meas, window = 3){
#First log meas
#Then window n points
#Fit lm model and get slope?
#fit next model and differnce slope?
}
# Second Idea:
# Some differences function
differences <- function(times, meas, showplot = FALSE){
ans <- rep(NA, length(meas))
ans[1] <- 0
for (i in 1:(length(meas)-1)){
slope <- meas[i+1] - meas[i]
ans[i+1] <- slope
}
if(showplot == TRUE){
plot(times, ans, type = "l")
}
return(ans)
}
# Create function to find derivs? or changes
# First Idea:
# Some weird slope function
deriv <- function(times, meas){
# first we need to log y
log_y <- log(meas)
ans <- rep(NA, length(meas))
ans[1] <- 0
for (i in 1:(length(log_y)-1)){
slope <- abs(((log_y[i+1] - log_y[i]) / ((times[i+1] - length(times)/2) - meas[i])))
ans[i+1] <- slope
}
return(ans)
}
x = -10:10
y = exp(x) / (1 + exp(x))
z = y + rnorm(length(y), 0,.02)
x2 = 0:20
plot(x2, z)
test <- deriv(time = x2, meas = z)
test
plot(x2, test)
test <- differences(time = x2, meas = z, showplot = TRUE)
test
lag <- lagtime(time = x2, meas = z, differences = test, showplot = TRUE)
lag
# Create function to find lag time
lagtime <- function(time, meas, differences, showplot = FALSE){
# first find max point in differences
maxgrowth <- which.max(differences)
# need slope
slope1 <- ((meas[maxgrowth + 1] - meas[maxgrowth]) / (time[maxgrowth + 1] - time[maxgrowth]))
slope2 <- ((meas[maxgrowth] - meas[maxgrowth - 1]) / (time[maxgrowth] - time[maxgrowth - 1]))
slope <- (slope1 + slope2) / 2
#fit tangent line to the point
y <- slope * (time - time[maxgrowth]) + meas[maxgrowth]
# y−y1=m(x−x1)
#find where it intersects with min meas value
min_meas <- min(meas)
lag <- ((min_meas - meas[maxgrowth]) / slope) + time[maxgrowth]
if(showplot == TRUE){
plot(time, meas)
lines(time, y)
abline(h = min_meas)
abline(v = lag)
}
#return lagtime
return(lag)
}
lag <- lagtime(time = x2, meas = z, differences = test, showplot = TRUE)
lag
plot(x2, z)
abline(v = 7.484296)
plot(x2, log(z))
abline(v = 7.484296)
x = -20:20
y = exp(x) / (1 + exp(x))
z = y + rnorm(length(y), 0,.02)
x2 = 0:40
plot(x2, z)
test <- deriv(time = x2, meas = z)
test
plot(x2, test)
test <- differences(time = x2, meas = z, showplot = TRUE)
test
lag <- lagtime(time = x2, meas = z, differences = test, showplot = TRUE)
plot(x2, log(z))
abline(v = 7.484296)
plot(x2, z)
?log
plot(x2, log(z))
x = -20:20
y = exp(x) / (1 + exp(x))
z = y + rnorm(length(y), 0,.02) + .1
x2 = 0:40
plot(x2, z)
test <- deriv(time = x2, meas = z)
test
plot(x2, test)
test <- differences(time = x2, meas = z, showplot = TRUE)
test
lag <- lagtime(time = x2, meas = z, differences = test, showplot = TRUE)
plot(x2, log(z))
abline(v = 7.484296)
plot(x2, z)
lag <- lagtime(time = x2, meas = z, differences = test, showplot = TRUE)
lag
abline(v = 17.55913)
plot(x2, log(z))
abline(v = 17.55913)
?which
test <- c(1,2,3,4,5,6)
which(test > 3)
meas <- c(1,2,3,4,5,6)
meas[1:3]
meas[1:]
meas[1:0]
meas[1:-1]
meas[1:end]
meas[-(1:2)]
which(test > 3)
length(which(test > 3))
meas[-(1:length(which(test > 3)))]
length(which(test > 4))
meas[-(1:length(which(test > 4)))]
which(test > 4)
meas[length(which(test > 4):length(meas)]
meas[length(which(test > 4)):length(meas)]
length(which(test > 4))
which(test > 4)
meas[(length(meas) - length(which(test > 4))):length(meas)]
?setdiff
setdiff(1, 2)
setdiff(1, 4)
